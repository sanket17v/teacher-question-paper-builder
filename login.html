<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Teacher Question Paper Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            background: #0f172a;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>

<body class="flex items-center justify-center min-h-screen text-white relative overflow-hidden">

    <!-- Background Decoration -->
    <div
        class="absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-purple-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob">
    </div>
    <div
        class="absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-blue-600 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-blob animation-delay-2000">
    </div>

    <div class="w-full max-w-md p-8 rounded-2xl glass-panel shadow-2xl relative z-10">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">
                Welcome Back</h1>
            <p class="text-gray-400 mt-2">Sign in to manage question papers</p>
        </div>

        <form id="authForm" class="space-y-6">
            <div id="nameField" class="hidden space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Full Name</label>
                    <input type="text" id="name"
                        class="w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-blue-500 transition-colors"
                        placeholder="John Doe">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Phone Number</label>
                    <input type="tel" id="phone"
                        class="w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-blue-500 transition-colors"
                        placeholder="1234567890">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-1">Role</label>
                    <select id="role"
                        class="w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-blue-500 transition-colors">
                        <option value="Faculty">Faculty</option>
                        <option value="Admin">Admin</option>
                        <option value="HOD">HOD</option>
                    </select>
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-300 mb-1">Email Address</label>
                <input type="email" id="email" required
                    class="w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-blue-500 transition-colors"
                    placeholder="teacher@example.com">
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-300 mb-1">Password</label>
                <input type="password" id="password" required
                    class="w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-blue-500 transition-colors"
                    placeholder="••••••••">
            </div>

            <button type="submit"
                class="w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold rounded-lg transition-all transform hover:scale-[1.02] shadow-lg">
                <span id="submitText">Sign In</span>
            </button>
        </form>

        <div class="mt-6 text-center">
            <p class="text-gray-400 text-sm">
                <span id="toggleText">Don't have an account?</span>
                <button id="toggleAuth"
                    class="text-blue-400 hover:text-blue-300 font-medium ml-1 transition-colors">Sign Up</button>
            </p>
        </div>
        <div id="errorMsg" class="mt-4 text-red-400 text-sm text-center hidden"></div>
    </div>

    <script src="js/api.js"></script>
    <script>
        const authForm = document.getElementById('authForm');
        const nameField = document.getElementById('nameField');
        const submitText = document.getElementById('submitText');
        const toggleText = document.getElementById('toggleText');
        const toggleAuth = document.getElementById('toggleAuth');
        const errorMsg = document.getElementById('errorMsg');

        let isLogin = true;

        toggleAuth.addEventListener('click', () => {
            isLogin = !isLogin;
            nameField.classList.toggle('hidden');
            submitText.textContent = isLogin ? 'Sign In' : 'Sign Up';
            toggleText.textContent = isLogin ? "Don't have an account?" : "Already have an account?";
            toggleAuth.textContent = isLogin ? 'Sign Up' : 'Sign In';
            errorMsg.classList.add('hidden');
        });

        authForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const role = document.getElementById('role').value;

            const endpoint = isLogin ? '/auth/login' : '/auth/register';
            const payload = isLogin ? { email, password } : { name, email, password, phone, role };

            try {
                const res = await api.post(endpoint, payload);
                if (res.token) {
                    localStorage.setItem('token', res.token);
                    localStorage.setItem('user', JSON.stringify(res));
                    window.location.href = 'dashboard.html';
                } else {
                    errorMsg.textContent = res.message || 'Authentication failed';
                    errorMsg.classList.remove('hidden');
                }
            } catch (err) {
                errorMsg.textContent = 'Network error provided in API';
                errorMsg.classList.remove('hidden');
            }
        });
    </script>
</body>

</html>